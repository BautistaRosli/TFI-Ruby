
<% content_for :stylesheets do %>
  <%= stylesheet_link_tag "application", media: "all" %>
<% end %>
<div class="users-container">
    <div class="users-grid">
        <% @users.each do |user| %>

            <% if can? :update, user %>

                <%= link_to admin_user_path(user), class: "user-card" do %>

                    <div class="user-avatar">
                        <%= user.name.first.upcase + user.lastname.first.upcase %>
                    </div>

                    <div class="user-info">
                        <h3 class="user-name"><%= user.name + (user == current_user ? " (tÃº)" : "") %></h3>
                        <p class="user-apellido"><%= user.lastname %></p>
                        <p class="user-username"><%= user.email %></p>
                        <span class="user-role"><%= user.role %></span>
                    </div>
                    <% if can?(:delete, user) && user.id != current_user.id %>
                        <% if user.is_active %>
                            <%= button_to "Eliminar Usuario",
                                admin_user_path(user),
                                method: :delete,
                                class: "btn-user-action btn-delete" %>
                        <% else %>
                            <%= button_to "Reactivar Usuario",
                                reactivate_admin_user_path(user),
                                method: :patch,
                                class: "btn-user-action btn-reactivate" %>
                        <% end %>
                    <% end %>

                <% end %> <!-- cierre del link_to -->

            <% else %>

                <div class="user-card user-card-disabled">

                    <div class="user-avatar">
                        <%= user.name.first.upcase + user.lastname.first.upcase %>
                    </div>

                    <div class="user-info">
                        <h3 class="user-name"><%= user.name %></h3>
                        <p class="user-apellido"><%= user.lastname %></p>
                        <p class="user-username"><%= user.email %></p>
                        <span class="user-role"><%= user.role %></span>
                    </div>

                    <% if can?(:delete, user) && user.id != current_user.id %>
                        <% if user.is_active %>
                            <%= button_to "Eliminar Usuario",
                                admin_user_path(user),
                                method: :delete,
                                class: "btn-user-action btn-delete" %>
                        <% else %>
                            <%= button_to "Reactivar Usuario",
                                reactivate_admin_user_path(user),
                                method: :patch,
                                class: "btn-user-action btn-reactivate" %>
                        <% end %>
                    <% end %>

                </div>

            <% end %>

        <% end %>
    </div>
</div>

<div class="create-user-button-container">
    <% if can? :create, current_user %>
        <%= button_to "Crear Usuario", new_admin_user_path, method: :get, class: "btn" %>
    <% end %>
</div>

<%= paginate @users %>



