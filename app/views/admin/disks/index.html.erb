<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Seleccionar Discos para la Venta</h1>
    <div>
      <%= link_to cart_admin_sales_path, class: "btn btn-primary me-2" do %>
        <i class="bi bi-cart3"></i> 
          Ver Carrito
          <% if session[:cart] && session[:cart]['items'] %>
            (<%= session[:cart]['items'].size %>)
          <% end %>    
      <% end %>
      <%= link_to "Volver a Ventas", admin_sales_path, class: "btn btn-secondary" %>
    </div>
  </div>

  <% if @disks.any? %>
    <div class="row">
      <% @disks.each do |disk| %>
        <div class="col-md-6 col-lg-4 mb-4">
          <div class="card h-100">
            <div class="card-body">
              <h5 class="card-title"><%= disk.name %></h5>
              <p class="card-text">
                <strong>Precio:</strong> $<%= number_with_precision(disk.unit_price, precision: 2) %><br>
                <strong>Stock:</strong> <%= disk.stock %> unidades<br>
                <strong>Formato:</strong> <span class="badge bg-info"><%= disk.format %></span>
              </p>
              
              <%= form_with url: add_item_admin_sales_path, method: :post, class: "mt-3" do |f| %>
                <%= f.hidden_field :disk_id, value: disk.id %>
                <div class="input-group">
                  <%= f.number_field :units_sold, 
                      value: 1, 
                      min: 1, 
                      max: disk.stock,
                      class: "form-control", 
                      placeholder: "Cantidad" %>
                  <%= f.submit "Agregar", class: "btn btn-success" %>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </div>

    <div class="d-flex justify-content-center mt-4">
      <%= paginate @disks %>
    </div>
  <% else %>
    <div class="alert alert-info">
      No hay discos disponibles con stock en este momento.
    </div>
  <% end %>
</div>
